<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta content="height=device-height, width=device-width, initial-scale=0.5, maximum-scale=0.6, user-scalable=1" name="viewport" />
<title>TIME</title>

<link href="https://wzh656.github.io/notice/css/button.css" rel="stylesheet" type="text/css" />
<link href="https://wzh656.github.io/notice/css/title.css" rel="stylesheet" type="text/css" />
<link href="https://wzh656.github.io/notice/css/clear.css" rel="stylesheet" type="text/css" />
<link href="https://wzh656.github.io/notice/css/p.css" rel="stylesheet" type="text/css" />

<style>
p{
	text-align: center;
	/* 设置背景透明色 */
	background-image: -webkit-linear-gradient(left, blue,
		#66ffff 10%, #cc00ff 20%,
		#CC00CC 30%, #CCCCFF 40%,
		#00FFFF 50%, #CCCCFF 60%,
		#CC00CC 70%, #CC00FF 80%,
		#66FFFF 90%, blue 100%
	);
	/* 改变background-size是为了让动画动起来 */
	background-size: 200% 100%;
	/* 按照文字拆分背景 */
	-webkit-background-clip: text;
	/* 将字体设置成透明色 */
	-webkit-text-fill-color: transparent;
	/* 启用动画 */
	animation: masked-animation 4s linear infinite;
}
@keyframes masked-animation {
    0% {
        background-position: 0 0;
    }
    100% {
        background-position: -100% 0;
    }
}


div .wrap{
	border:2px solid #000;
	border-radius:33.3%;
}
.clock1 .zhen{
	position:absolute;
	left:50%;
	top:25%;
	transform-origin:0% 50%;
	border-radius:1px;
}
.clock2 .zhen{
	position:absolute;
	left:50%;
	top:75%;
	transform-origin:0% 50%;
	border-radius:1px;
}
</style>

<script src="https://lib.sinaapp.com/js/jquery/2.0.2/jquery-2.0.2.min.js"></script>
<script src="https://wzh656.github.io/notice/js/choice.js"></script>
<script src="https://wzh656.github.io/notice/js/msgbox.js"></script>

<!--
<script src="//cdn.jsdelivr.net/npm/eruda"></script>
<script>
eruda.init();
console.log('控制台打印信息');
</script>
-->

</head>
<body bgcolor="#fa6">
<button onclick="share();" style="position:absolute;top:0px;right:0px;height:66px;width:66px;font-size:20px;">Share</button>
<script>
function share(){
	share_choice=new Choice(
		[
			{
				name:"Share with QQ Friends",
				onclick:function(){
					window.open('http://connect.qq.com/widget/shareqq/index.html?url=https%3A%2F%2Fwzh656.github.io%2FCountdown&sharesource=qzone&title=%E5%80%92%E8%AE%A1%E6%97%B6&pics=https%3A%2F%2Ftimgsa.baidu.com%2Ftimg%3Fimage%26quality%3D80%26size%3Db9999_10000%26sec%3D1582193633481%26di%3D29b51f42036264035b6fa3523f943252%26imgtype%3D0%26src%3Dhttp%253A%252F%252Fandroid-artworks.25pp.com%252Ffs08%252F2017%252F09%252F30%252F1%252F2_5e76f9b9dfb0837370bcbcc6fde37708_con.png&summary=%E5%8D%B3%E5%B0%86%E5%BC%80%E5%AD%A6%E8%80%83%EF%BC%8C%E7%9C%8B%E7%9C%8B%E8%BF%98%E6%9C%89%E5%87%A0%E5%A4%A9&desc=%5E%5E%5E%E5%80%92%E8%AE%A1%E6%97%B6%5E%5E%5E');
					share_chioce.close();
				},
				height:"66px",
				font_size:"36px"
			},
			{
				name:"Share in QQ Space",
				onclick:function(){
					window.open('https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https%3A%2F%2Fwzh656.github.io%2FCountdown&sharesource=qzone&title=%E5%80%92%E8%AE%A1%E6%97%B6&pics=https%3A%2F%2Ftimgsa.baidu.com%2Ftimg%3Fimage%26quality%3D80%26size%3Db9999_10000%26sec%3D1582193633481%26di%3D29b51f42036264035b6fa3523f943252%26imgtype%3D0%26src%3Dhttp%253A%252F%252Fandroid-artworks.25pp.com%252Ffs08%252F2017%252F09%252F30%252F1%252F2_5e76f9b9dfb0837370bcbcc6fde37708_con.png&summary=%E5%8D%B3%E5%B0%86%E5%BC%80%E5%AD%A6%E8%80%83%EF%BC%8C%E7%9C%8B%E7%9C%8B%E8%BF%98%E6%9C%89%E5%87%A0%E5%A4%A9&desc=%5E%5E%5E%E5%80%92%E8%AE%A1%E6%97%B6%5E%5E%5E');
					share_choice.close();
				},
				height:"66px",
				font_size:"36px"
			},
			{
				name:"取消",
				onclick:function(){
					share_choice.close();
				},
				height:"66px",
				font_size:"36px",
				color:"red"
			}
		]
	).show();
}
</script>
<h1>倒计时</h1>
<hr/>
<div style="position:fixed;top:10%;right:0%;">
	<div class="clock1">
		<div class="wrap" style="width:200px;height:200px;">跳动的钟</div>
		<div class="zhen" style="width:100px;height:2px;background-color:#0f0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;毫秒针</div>
		<div class="zhen" style="width:85.714px;height:2px;background-color:#3d0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;秒针</div>
		<div class="zhen" style="width:71.429px;height:2px;background-color:#5bb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分针</div>
		<div class="zhen" style="width:57.143px;height:2px;background-color:#880;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;时针</div>
		<div class="zhen" style="width:42.857px;height:2px;background-color:#b50;">&nbsp;&nbsp;&nbsp;&nbsp;日针</div>
		<div class="zhen" style="width:28.571px;height:2px;background-color:#d33;">&nbsp;&nbsp;月针</div>
		<div class="zhen" style="width:14.286px;height:2px;background-color:#f00;">年针</div>
	</div>
	<div class="clock2">
		<div class="wrap" style="width:200px;height:200px;">平滑的钟</div>
		<div class="zhen" style="width:100px;height:2px;background-color:#0f0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;毫秒针</div>
		<div class="zhen" style="width:85.714px;height:2px;background-color:#3d0;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;秒针</div>
		<div class="zhen" style="width:71.429px;height:2px;background-color:#5bb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分针</div>
		<div class="zhen" style="width:57.143px;height:2px;background-color:#880;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;时针</div>
		<div class="zhen" style="width:42.857px;height:2px;background-color:#b50;">&nbsp;&nbsp;&nbsp;&nbsp;日针</div>
		<div class="zhen" style="width:28.571px;height:2px;background-color:#d33;">&nbsp;&nbsp;月针</div>
		<div class="zhen" style="width:14.286px;height:2px;background-color:#f00;">年针</div>
	</div>
</div>

<script>
clock_hide=false;
function hide_clock(){
	if (clock_hide){
		$(".clock1,.clock2,.wrap,.zhen").fadeIn("slow");
		$("button")[2].innerHTML="Hide Clock";
	}else{
		$(".clock1,.clock2,.wrap,.zhen").hide("slow");
		$("button")[2].innerHTML="Show Clock";
	}
	clock_hide=!clock_hide;
}
</script>

<button onclick="for (var i in event){clearTimeout(event[i]);};alert('STOP TIME\nSuccess');alert('BYE\n--<TIME>');">STOP "TIME"</button>
<button onclick="hide_clock();">Hide clock</button>

<p id="now">看看你的浏览器，像是支持这个倒计时的吗？</p>
<hr/>
<div id="time_father">
	<div class="time" style="border:2px solid #000;">还不去换个浏览器（不关我的事，这一定没BUG）</div>
</div>
<p id="m">Time goes so quickly,but what are you doing?Are you preparing for the exam or playing games like DESK-GOOD(GOOD-TABLE)?</p>
<script>
m=document.getElementById("m");

var event=new Array;
function monthDay(){
	var date = new Date();
	var year = date.getFullYear();
	var month = date.getMonth()+1;
	var d = new Date(year, month, 0);
	return d.getDate();
}

function timeToWord(between){
	return (
		between+"ms<br>="+
		(between/1000)+"s<br>="+
		(between/1000/60)+"min<br>="+
		(between/1000/60/60)+"h<br>="+
		(between/1000/60/60/24)+"days<br>合"+
		Math.floor(between/1000/60/60/24)+"days（约"+
		Math.floor(between/1000/60/60/24/365.2425)+"年+"+
		Math.floor(between/1000/60/60/24/7%52.1775)+"周+"+
		Math.floor(between/1000/60/60/24%7)+"天）"+
		Math.floor(between/1000/60/60%24)+"h"+
		Math.floor(between/1000/60%60)+"min"+
		Math.floor(between/1000%60)+"s"+
		Math.floor(between%1000)+"ms<br>"
	);
}

function time(index, decision, msg){
	now = new Date();
	if (!clock_hide){
		$(".clock1 .zhen")[0].style.transform="rotate("+((now.getMilliseconds())/1000*360-90)+"deg)";
		$(".clock1 .zhen")[1].style.transform="rotate("+((now.getSeconds()/*+now.getMilliseconds()/1000*/)/60*360-90)+"deg)";
		$(".clock1 .zhen")[2].style.transform="rotate("+((now.getMinutes()/*+now.getSeconds()/60+now.getMilliseconds()/1000/60*/)/60*360-90)+"deg)";
		$(".clock1 .zhen")[3].style.transform="rotate("+((now.getHours()/*+now.getMinutes()/60+now.getSeconds()/60/60+now.getMilliseconds()/1000/60/60*/)/24*360-90)+"deg)";
		$(".clock1 .zhen")[4].style.transform="rotate("+(((now.getDate()-1)/*+now.getHours()/24+now.getMinutes()/60/24+now.getSeconds()/60/60/24+now.getMilliseconds()/1000/60/60/24*/)/monthDay()*360-90)+"deg)";
		$(".clock1 .zhen")[5].style.transform="rotate("+((now.getMonth()/*+(now.getDate()-1)/monthDay()+now.getHours()/24/monthDay()+now.getMinutes()/60/24/monthDay()+now.getSeconds()/60/60/24/monthDay()+now.getMilliseconds()/1000/60/60/24/monthDay()*/)/12*360-90)+"deg)";
		$(".clock1 .zhen")[6].style.transform="rotate("+((now.getYear()/*+now.getMonth()/12+(now.getDate()-1)/monthDay()/12+now.getHours()/24/monthDay()/12+now.getMinutes()/60/24/monthDay()/12+now.getSeconds()/60/60/24/monthDay()/12+now.getMilliseconds()/1000/60/60/24/monthDay()/12*/)/100*360-90)+"deg)";
		
		$(".clock2 .zhen")[0].style.transform="rotate("+((now.getMilliseconds())/1000*360-90)+"deg)";
		$(".clock2 .zhen")[1].style.transform="rotate("+((now.getSeconds()+now.getMilliseconds()/1000)/60*360-90)+"deg)";
		$(".clock2 .zhen")[2].style.transform="rotate("+((now.getMinutes()+now.getSeconds()/60+now.getMilliseconds()/1000/60)/60*360-90)+"deg)";
		$(".clock2 .zhen")[3].style.transform="rotate("+((now.getHours()+now.getMinutes()/60+now.getSeconds()/60/60+now.getMilliseconds()/1000/60/60)/24*360-90)+"deg)";
		$(".clock2 .zhen")[4].style.transform="rotate("+(((now.getDate()-1)+now.getHours()/24+now.getMinutes()/60/24+now.getSeconds()/60/60/24+now.getMilliseconds()/1000/60/60/24)/monthDay()*360-90)+"deg)";
		$(".clock2 .zhen")[5].style.transform="rotate("+((now.getMonth()+(now.getDate()-1)/monthDay()+now.getHours()/24/monthDay()+now.getMinutes()/60/24/monthDay()+now.getSeconds()/60/60/24/monthDay()+now.getMilliseconds()/1000/60/60/24/monthDay())/12*360-90)+"deg)";
		$(".clock2 .zhen")[6].style.transform="rotate("+((now.getYear()+now.getMonth()/12+(now.getDate()-1)/monthDay()/12+now.getHours()/24/monthDay()/12+now.getMinutes()/60/24/monthDay()/12+now.getSeconds()/60/60/24/monthDay()/12+now.getMilliseconds()/1000/60/60/24/monthDay()/12)/100*360-90)+"deg)";
	}
	var between = [msg["start"]-now, now-msg["end"]];
	
	$(".time")[index].style.color = msg["color"];
	$(".time")[index].style.backgroundColor = msg["background-color"];
	if (between[0] > 0){ // -will
		document.title="TIME:"+"("+Number(now)+")";
		$("#now")[0].innerHTML="NOW:"+now+"("+Number(now)+")";
		$(".time")[index].innerHTML=
			"<br><span style='background-color:#000;color:#fff;'>"+decision+"</span><br>"+
			"FROM 「<b>"+decision+"</b>(will将来时)」"+
				(
					Number(msg["start"]) == Number(msg["end"])?
					"非延续性（"+msg["start"]+"）":
					"持续<br>"+timeToWord(msg["end"]-msg["start"])+"（"+msg["start"]+"~"+msg["end"]+"）"
				)+
			" ONLY：<br>"+
			timeToWord(between[0])
			" LATER<hr/>";
		;
	}else if (between[0] <= 0 & between[1] <= 0){ // -ing
		document.title="TIME:"+"("+Number(now)+")";
		$("#now")[0].innerHTML="NOW:"+now+"("+Number(now)+")";
		$(".time")[index].innerHTML=
			"<br><span style='background-color:#000;color:#fff;'>"+decision+"</span><br>"+
			"FROM 「<b>"+decision+"</b>(ing正在进行时)」"+
				(
					Number(msg["start"]) == Number(msg["end"])?
					"非延续性（"+msg["start"]+"）":
					"持续<br>"+timeToWord(msg["end"]-msg["start"])+"（"+msg["start"]+"~"+msg["end"]+"）"
				)+
			" ONLY：<br>"+
			timeToWord(between[1])
			" LATER<hr/>";
		;
	}else{ // -ed
		document.title="TIME:"+"("+Number(now)+")";
		$("#now")[0].innerHTML="NOW:"+now+"("+Number(now)+")";
		$(".time")[index].innerHTML=
			"<br><del><span style='background-color:#000;color:#fff;'>"+decision+"</span><br>"+
			"FROM 「<b>"+decision+"</b>(ed过去/完成时)」"+
				(
					Number(msg["start"]) == Number(msg["end"])?
					"非延续性（"+msg["start"]+"）":
					"持续<br>"+timeToWord(msg["end"]-msg["start"])+"（"+msg["start"]+"~"+msg["end"]+"）"
				)+
			" ALREADY WENT BEFORE：<br>"+
			timeToWord(between[1])
			" AGO</del><hr/>";
		;
	}
}

var waiting;
waiting=new Msgbox(
	{
		name:"加载中",
		font_size:"36px"
	},
	{
		name:"获取服务器信息中……"
	},[
		{
			name:"退出",
			onclick:function(){
				window.close();
			},
			width:"100%",
			font_size:"26px"
		}
	],
	"loading"
).show();

var message;
$.ajax({
	type: "get",
	url: "https://wzh656.github.io/notice/Countdown.js",
	dataType: 'text',
	async: false,
	success: function(data){
		eval("message="+data);
		if (typeof(message) == "object"){
			localStorage.setItem("倒计时_服务器信息缓存", data);
			if (message["message"] !== ""){
				alert(message["message"]);
			}
			waiting.close();
		}else{
			if (confirm("获取信息出错！\n是否使用上次获取成功时的缓存？")){
				eval("message="+localStorage.getItem("倒计时_服务器信息缓存"));
				if (typeof(message) == "object"){
					if (message["message"] !== ""){
						alert(message["message"]);
					}
					waiting.close();
				}else{
					alert("使用缓存出错，点击退出");
					window.close();
				}
			}else{
				alert("点击退出");
				window.close();
			}
		}
	},
	error: function(xhr, type){
		if (confirm("错误！\n无法获取服务器信息。\ntype:"+type+"\n是否使用上次获取成功时的缓存？")){
				eval("message="+localStorage.getItem("倒计时_服务器信息缓存"));
				if (typeof(message) == "object"){
					if (message["message"]!==""){
						alert(message["message"]);
					}
				}else{
					alert("使用缓存出错，点击退出");
					window.close();
				}
			}else{
				alert("点击退出");
				window.close();
			}
	}
});

for (var i=0;i<Object.keys(message["date"]).length-1;i++){
	$("#time_father")[0].innerHTML+=`<div class="time" style="border:2px solid #000;"></div>`;
}

for (let i in message["date"]){
	event.push(
		setInterval(function (){
			time(Object.keys(message["date"]).findIndex(x => x == i), i, message["date"][i]);
		},10)
	)
}
/* event.push(
	setInterval(function(){
		var index=0;
		for (var i in message["date"]){
			time(index, i, message["date"][i]);
			index++;
		}
	},1)
); */

var colors=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];
var choice_color=[0,0,0,0,0,0];
var fx=[1,1,1];
event.push(setInterval(function(){
	for (var i=0;i<3;i++){
		choice_color[i]+=fx[i]*Math.round(Math.random());
		if (choice_color[i] >= colors.length-1){
			fx[i]=-1;
		}else if (choice_color[i] <= 0){
			fx[i]=1;
		}
	}
	
	$(".wrap")[0].style.background="#"+colors[choice_color[0]]+colors[choice_color[1]]+colors[choice_color[2]];
	$(".wrap")[1].style.background="#"+colors[15-choice_color[0]]+colors[15-choice_color[1]]+colors[15-choice_color[2]];
},200)
);
event.push(setInterval(function(){
	choice_color[5]++;
	if (choice_color[5] >= 15){
		choice_color[5]-=15;
		choice_color[4]++;
	}
	if (choice_color[4] >= 15){
		choice_color[4]-=15;
		choice_color[3]++;
	}
	if (choice_color[3] >= 15){
		choice_color[3]-=15;
	}
	$(".time")[message["color"]].style.color="#"+colors[choice_color[3]]+colors[choice_color[4]]+colors[choice_color[5]];
},0));
</script>
<footer style="float:right;color:#059;">MADE BY WZH</footer>
</body>
</html>
